
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>lianghaijun的博客</title>
  <meta name="author" content="seavers">

  
  <meta name="description" content="网速越来越快了, 需要存硬盘的东西越来越少了 电影 没必要下载电影了, 随时随地观看在线电影,直播电视, 怀旧连续剧等 (pplive,youku)
音乐 在线音乐,在线播放列表,在线mv,最新最热歌曲,各类频道 (ting, yinyuetai)
电子书 不必把大量的电子书, 存放在硬盘里, &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lianghaijun.com/blog/page/7/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
  <link href="/atom.xml" rel="alternate" title="lianghaijun的博客" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
</head>

<body   >
  <header role="banner"><hgroup>
  <div id="wb_connect_btn"></div>
  <h1><a href="/">lianghaijun的博客</a></h1>
  
    <h2>Looking for Interest</h2>
  
</hgroup>
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:lianghaijun.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives/">Archives</a></li>
  <li><a href="/blog/picture/">picture</a><li>
  <li><a href="/blog/link/">link</a></li>
  <li><a href="/blog/about/">about</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012-06-29-1570934.html">硬盘里还能存点啥?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-29T13:21:00+08:00" pubdate data-updated="true">Jun 29<span>th</span>, 2012</time>
      </p>
    
  </header>


  <div class="entry-content"><p>网速越来越快了, 需要存硬盘的东西越来越少了</p>

<ul>
<li>电影      没必要下载电影了, 随时随地观看在线电影,直播电视, 怀旧连续剧等   (pplive,youku)</li>
<li>音乐      在线音乐,在线播放列表,在线mv,最新最热歌曲,各类频道  (ting, yinyuetai)</li>
<li>电子书    不必把大量的电子书, 存放在硬盘里, 多是看一遍后, 就存下来了, 以后就很少翻了, 看着4.5个G的电子书, 删也不是, 不删也不是, 还是网络共享下, 大家共同学习.  (w3school, open开源文档)</li>
<li>书签      浏览器的书签,没必要备份在本地了, 也没有必要换电脑或重装系统时备份了,     (chrome书签同步)</li>
<li>安装程序  自己本地有个5G的TDDownload, 发现这些安装程序, 很少用, 且版本总是很旧, 或者多版本共存,该整理下了,换软件管理吧      (360软件管家)</li>
<li>代码      自己的代码 or 别人的代码,还是用版本控制吧     (github,googlecode)</li>
<li>工具包    java的jar包吗?  用maven吧,只记录地址    (maven)</li>
<li>文档      自己的一些文档,压缩一下备份在网络上     (各类网盘)</li>
<li>笔记      一些小碎文字,如cdkey,桌面上的小心得     (云笔记)</li>
<li>游戏      小游戏,flash游戏,在线游戏等,  如果网络够快,将来的大型网游,也可随时下载</li>
<li>驱动      驱动一般都有地方下载,如果用书签就更好了 (mydrivers 或 官网吧)</li>
<li>其它      如各类backup, 等&hellip;</li>
</ul>


<p>细数下来
* 硬盘的功能, 越来越像一个cache了, 程序的cache,数据的cache,只是做个中转.   ]* 硬盘大小不够时,可以随时删除,随时从服务端再获取
* 将来我们的电脑,会不会就像ipad一样</p>

<pre><code>1. 在线商店里, 双击某个应用, 开始自动安装
2. 自动将程序装在 D:\program files\
3. 自动将数据装在 D:\Users\xx\Application Data , 并自动服务端同步
4. 然后, 打开应用, 正常使用
5. 使用过程中, 将配置,数据自动同步,  某些cache,找个大盘自动cache
6. 不需要理会装在哪里,不需要理会数据备份问题,都由软件来解决吧
</code></pre>

<ul>
<li>这个就是传说中的app模式, ipad, 360桌面, Q+, win8, 似乎都有这个意向&hellip;</li>
</ul>


<p>还有哪些会存在硬盘里呢:</p>

<ol>
<li>个人私密文档,私密照片,不适宜共享   (包括私密电影?)</li>
<li>超大文件,   下载起来费事, 如游戏客户端,大型软件安装程序</li>
<li>其它</li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012-06-07-1553882.html">mini javascript loader</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-07T00:56:00+08:00" pubdate data-updated="true">Jun 7<span>th</span>, 2012</time>
      </p>
    
  </header>


  <div class="entry-content"><p>[size=medium]
自己写的一个mini 且 simple 的 javascript loader</p>

<p>功能特点</p>

<ul>
<li>异步并行载入js, 每个js只加载一次</li>
<li>支持模块依赖, 未检测循环依赖</li>
<li>支持别名</li>
<li>兼容ie6+ , firefox, chrome &hellip;</li>
<li>API :<br/>
 define.alias[&lsquo;modName&rsquo;] = &lsquo;<a href="http://path/to/mods/root/dir">http://path/to/mods/root/dir</a>&rsquo;
 define(deps, callback)   其中 callback(dep1, dep2, dep3&hellip;)
 require(deps, callback)   其中 callback(dep1, dep2, dep3&hellip;)</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>define = (function() {
</span><span class='line'>  
</span><span class='line'>  var modules = {};
</span><span class='line'>  var modulesCallbacks = {};
</span><span class='line'>  var alias = window.alias || {};
</span><span class='line'>
</span><span class='line'>  function map(arr, callback) {
</span><span class='line'>      var ret = [];
</span><span class='line'>      for(var i = 0; i &lt; arr.length; i++) {
</span><span class='line'>          ret.push(callback(arr[i], i, arr));
</span><span class='line'>      }
</span><span class='line'>      return ret;
</span><span class='line'>  }
</span><span class='line'>  function isString(obj) {
</span><span class='line'>      return typeof(obj) == 'string';
</span><span class='line'>  }
</span><span class='line'>  function isArray(obj) {
</span><span class='line'>      return Object.prototype.toString.call(obj) == '[object Array]';
</span><span class='line'>  }
</span><span class='line'>  function isFunction(obj) {
</span><span class='line'>      return typeof(obj) == 'function';
</span><span class='line'>  }
</span><span class='line'>  function mix(src, dst) {
</span><span class='line'>      for(var key in dst) {
</span><span class='line'>          src[key] = dst[key];
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>  function getScript(url, callback) {
</span><span class='line'>      var node = document.createElement("script");
</span><span class='line'>      node.async = true;
</span><span class='line'>      if (document.addEventListener) {
</span><span class='line'>          node.addEventListener('load', callback);
</span><span class='line'>      } else {
</span><span class='line'>          node.onreadystatechange = function () {
</span><span class='line'>              if(node.readyState == 'loaded' || node.readyState == 'complete') {
</span><span class='line'>                  callback && callback();
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      node.src = url;
</span><span class='line'>
</span><span class='line'>      var head = document.head || document.getElementsByTagName('head')[0] || document.documentElement;
</span><span class='line'>      head.insertBefore(node, head.firstChild);
</span><span class='line'>      return node;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  function getCurrentScript() {
</span><span class='line'>      
</span><span class='line'>      //firefox4 and opera
</span><span class='line'>      if (document.currentScript) {
</span><span class='line'>          return document.currentScript;
</span><span class='line'>      } else if (document.attachEvent) {
</span><span class='line'>          //ie6-9 得到当前正在执行的script标签
</span><span class='line'>          var scripts = document.getElementsByTagName('script');
</span><span class='line'>          for (var i = scripts.length - 1; i &gt; -1; i--) {
</span><span class='line'>              if (scripts[i].readyState === 'interactive') {
</span><span class='line'>                  return scripts[i];
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>      } else {
</span><span class='line'>          // 参考 https://github.com/samyk/jiagra/blob/master/jiagra.js
</span><span class='line'>          // chrome and firefox4以前的版本
</span><span class='line'>          var stack;
</span><span class='line'>          try {
</span><span class='line'>              makeReferenceError
</span><span class='line'>          } catch (e) {
</span><span class='line'>              stack = e.stack;
</span><span class='line'>          }
</span><span class='line'>          if (!stack)
</span><span class='line'>              return undefined;
</span><span class='line'>          // chrome uses at, ff uses @
</span><span class='line'>
</span><span class='line'>          var e = stack.indexOf(' at ') !== -1 ? ' at ' : '@';
</span><span class='line'>          while (stack.indexOf(e) !== -1) {
</span><span class='line'>              stack = stack.substring(stack.indexOf(e) + e.length);
</span><span class='line'>          }
</span><span class='line'>          stack = stack.replace(/:\d+:\d+$/ig, "");
</span><span class='line'>
</span><span class='line'>          var scripts = document.getElementsByTagName('script');
</span><span class='line'>          for (var i = scripts.length - 1; i &gt; -1; i--) {
</span><span class='line'>              if (scripts[i].src === stack) {
</span><span class='line'>                  return scripts[i];
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  function getScriptWithCache(url, callback) {
</span><span class='line'>      var scripts = this._scripts = this._scripts || {};
</span><span class='line'>      var cache = scripts;
</span><span class='line'>      if (cache === true) {
</span><span class='line'>          callback && callback();
</span><span class='line'>          return ;
</span><span class='line'>      } else if (isArray(cache)) {
</span><span class='line'>          cache.push(callback);
</span><span class='line'>          return ;
</span><span class='line'>      } else {
</span><span class='line'>          scripts = [callback];
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      getScript(url, function() {
</span><span class='line'>          var callbacks = scripts || [];
</span><span class='line'>          scripts = true;
</span><span class='line'>          for(var i = 0; i &lt; callbacks.length; i++) {
</span><span class='line'>              callbacks[i] && callbacks[i]();
</span><span class='line'>          }
</span><span class='line'>      });     
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  function getModule(mod, callback) {
</span><span class='line'>      if (!modules[mod]) {
</span><span class='line'>          modulesCallbacks[mod] = modulesCallbacks[mod] || [];
</span><span class='line'>          modulesCallbacks[mod].push(callback);
</span><span class='line'>
</span><span class='line'>          getScriptWithCache(mod);
</span><span class='line'>      } else {
</span><span class='line'>          callback && callback(modules[mod]);
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  function getModules(mods, callback) {
</span><span class='line'>      if (mods == undefined || mods.length == 0) {
</span><span class='line'>          callback && callback();
</span><span class='line'>          return ;
</span><span class='line'>      }
</span><span class='line'>      var c = 0;
</span><span class='line'>
</span><span class='line'>      var ret = [];
</span><span class='line'>      map(mods, function(mod, i) {
</span><span class='line'>          getModule(mod, function(obj) {
</span><span class='line'>              ret[i] = obj;
</span><span class='line'>
</span><span class='line'>              if (++c == mods.length) {
</span><span class='line'>                  callback && callback(ret);
</span><span class='line'>              }
</span><span class='line'>          });
</span><span class='line'>      });
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  function define(deps, callback) {
</span><span class='line'>      var container = this;
</span><span class='line'>
</span><span class='line'>      if (!isString(deps) && !isArray(deps)) {
</span><span class='line'>          callback = deps;
</span><span class='line'>          deps = [];
</span><span class='line'>      }
</span><span class='line'>      var current = getCurrentScript();
</span><span class='line'>      var url = current && current.src;
</span><span class='line'>
</span><span class='line'>      deps = deps || [];
</span><span class='line'>      if (isString(deps)) {
</span><span class='line'>          deps = deps.split(',');
</span><span class='line'>      }
</span><span class='line'>      var allDeps = map(deps, tran);              //全部转换映射
</span><span class='line'>
</span><span class='line'>      getModules(allDeps, function(mods) {
</span><span class='line'>          var ret = isFunction(callback) ? callback.apply(undefined, mods||[]) : callback;
</span><span class='line'>          modules = modules || {}
</span><span class='line'>          mix(modules, ret);
</span><span class='line'>
</span><span class='line'>          container != window && (mix(container, ret));
</span><span class='line'>
</span><span class='line'>          if (modulesCallbacks) {
</span><span class='line'>              for(var i = 0; i &lt; modulesCallbacks.length; i++) {
</span><span class='line'>                  modulesCallbacks[i](ret);
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>
</span><span class='line'>      return container;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  function tran(dep) {
</span><span class='line'>      for(var key in alias) {
</span><span class='line'>          dep = dep.replace(new RegExp('^' + key), alias[key]);       //TODO
</span><span class='line'>      }
</span><span class='line'>      return dep + '.js';
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  define.alias = alias;
</span><span class='line'>  return define;
</span><span class='line'>})();
</span></code></pre></td></tr></table></div></figure>


<p>测试用例</p>

<p>//上述代码保存为 <a href="http://localhost/loader/loader.js">http://localhost/loader/loader.js</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>&lt;!-- index.htm --&gt;
</span><span class='line'>&lt;script src="loader.js"&gt;&lt;/script&gt;
</span><span class='line'>
</span><span class='line'>&lt;script&gt;
</span><span class='line'>define.alias['ok'] = 'http://localhost/loader/';
</span><span class='line'>define(['ok/mod1', 'ok/mod2'], function(Mod1, Mod2) {
</span><span class='line'>  console.log('execute index ', Mod1, Mod2);
</span><span class='line'>});
</span><span class='line'>&lt;/script&gt;
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>//   http://localhost/loader/mod1.js
</span><span class='line'>require(['ok/mod2'], function(Mod2) {
</span><span class='line'>  console.log('mod1 index ', Mod2);
</span><span class='line'>
</span><span class='line'>  return {
</span><span class='line'>      mod1: 'this is mod1'
</span><span class='line'>  }
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>//   http://localhost/loader/mod2.js
</span><span class='line'>define(function() {
</span><span class='line'>  console.log('mod2 index ');
</span><span class='line'>
</span><span class='line'>  return {
</span><span class='line'>      'hello' : 'world'
</span><span class='line'>  }
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p>补: 其它用法</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//mod3.js
</span><span class='line'>//功能模块1
</span><span class='line'>define({
</span><span class='line'>    sayHello : function() {
</span><span class='line'>       console.log('hello');
</span><span class='line'>    }
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>//功能模块2, 模块2没支持!!!
</span><span class='line'>define(function() {
</span><span class='line'>    return {
</span><span class='line'>        sayWorld : function() {
</span><span class='line'>           console.log('world');
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>App = {define : define, require: define};
</span><span class='line'>App.define.alias['ok'] = 'http://lhj/loader';
</span><span class='line'>App.define({
</span><span class='line'>      showMsg : function(msg) {
</span><span class='line'>          console.log(msg);
</span><span class='line'>      }
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>App.define(function(Mod3) {
</span><span class='line'>      return {
</span><span class='line'>          say : function() {
</span><span class='line'>              App.require('ok/Mod3', function(Mod3) {
</span><span class='line'>                    return Mod3.sayHello() + ' ' + '';//Mod3.sayWorld();
</span><span class='line'>              });
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>App.showMsg(123);
</span><span class='line'>App.say();
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012-03-03-1439239.html">inline元素上支持的css属性</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-03T22:39:00+08:00" pubdate data-updated="true">Mar 3<span>rd</span>, 2012</time>
      </p>
    
  </header>


  <div class="entry-content"><p>今天在测试时,意外发现inline元素是可以设置background与border的, 之前有所误解, 故对其它的css属性重新回顾了下</p>

<p>随手写了一个demo:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;h3&gt;inline测试&lt;/h3&gt;
</span><span class='line'>&lt;div style="width:110px"&gt;&nbsp;
</span><span class='line'>&lt;a href="#" style="
</span><span class='line'>    background: #ccc;
</span><span class='line'>    padding: 11px;
</span><span class='line'>    margin-left: 80px;
</span><span class='line'>    line-height: 70px;
</span><span class='line'>    border: 1px solid blue;
</span><span class='line'>"&gt;display&lt;/a&gt;
</span><span class='line'>
</span><span class='line'>&lt;i href="#" style="
</span><span class='line'>    background: #ccc;
</span><span class='line'>    padding: 11px;
</span><span class='line'>    margin-left: 80px;
</span><span class='line'>    line-height: 70px;
</span><span class='line'>    border: 1px solid blue;
</span><span class='line'>    min-width: 10px;
</span><span class='line'>    min-height: 10px;
</span><span class='line'>    overflow: hidden;
</span><span class='line'>    max-width: 10px;
</span><span class='line'>    max-height: 10px;.;
</span><span class='line'>    resize: both;
</span><span class='line'>"&gt;inline&lt;/i&gt;
</span><span class='line'>&lt;/div&gt;
</span></code></pre></td></tr></table></div></figure>


<p>经测试
1. inline元素, 有效的: background, margin-left, margin-right, padding, border
2. inline元素, 无效的: width, height, margin-top, margin-bottom
3. 因width, height无效, 因此下列属性也无效: text-align, text-indent, min|max-width|height, overflow
4. 原文字相关的依然有效, 如word-spacing,  word-wrap,  white-space, letter-spacing
5. 下面两个有效, line-height, vertical-align, box-shadow
6. float,position及与之相关top,left, 不考虑, 已经不是inline了</p>

<p>其中 border, line-height, 这两个可以多多利用</p>

<p><em>思考:</em>
1. inline元素的宽高是不能定义, 即宽高度是由inline元素inline内容的元素决定的,(ie6,ie7下高度会受inline-block元素的影响)
2. 即宽高完全是自适应而得出的, 因此也不存在overflow的问题, min|max-width|height也没有影响
3. margin四个属性, left|right 与 top|bottom 有不同的待遇
4. margin-top, margin-bottom, 可以用line-height模拟, 但有很大不同, 与inline-block也不兼容,  另 margin:0 auto的居中效果, 也没有作用</p>

<p>*其次: *
1. div元素, 使用 display:inline 以上几条也成立
2. button元素, 使用display:inline, 样式没有变化, 等于于inline-block</p>

<p>*最后: *
mdn中说: 默认 inline-level 的元素 (inline + inline-block)</p>

<ul>
<li>b, big, i, small, tt</li>
<li>abbr, acronym, cite, code, dfn, em, kbd, strong, samp, var</li>
<li>a, bdo, br, img, map, object, q, script, span, sub, sup</li>
<li>button, input, label, select, textarea</li>
</ul>


<p>其中img, button, input, label, select, textarea 并没有以上的特征, 测试了一下, 设置inline与inline-block, 效果是一样的, 没有变化, 都等同于设置了inline-block</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012-02-21-1416013.html">利用bat反编译jar包生成源码jar包</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-21T22:27:00+08:00" pubdate data-updated="true">Feb 21<span>st</span>, 2012</time>
      </p>
    
  </header>


  <div class="entry-content"><p>之前曾发表在 csdn(blog.csdn.net/seavers) 上, 不过, csdn的代码乱掉了, 今天重新整理了一下</p>

<p>反编译所使用的工具是jad.exe,笔者的测试版本是1.5.8e,压缩与解压缩使用的是WinRAR</p>

<p>jad.exe 可反编译一个class文件为java文件,笔者的BAT可通过此工具将一个jar包反编译成一个完整的源码jar包,同时生成的目录也可以在eclipse中使用</p>

<p>jad.exe 官方网站 ： <a href="http://www.kpdus.com/jad.html">http://www.kpdus.com/jad.html</a>   (已失效, 从<a href="https://github.com/seavers/jad">这里</a>或者附件下载)</p>

<p>BAT脚本见后</p>

<p>安装方法如下:</p>

<pre><code>    复制粘贴后面的文本为一个BAT,然后与jad.exe放在同一个目录即可(WinRAR需正确安装)
</code></pre>

<p>使用方法如下:   (有3种使用方法, 使用其中任意一种均可,结果是相同的)</p>

<pre><code> 1. 双击BAT,提示输入需反编译的jar包,请输入完整的jar路径
 2. 直接将 jar 包拖放在bat上
 3.右键点击jar包,选择打开方式,然后选择使用该BAT来执行
</code></pre>

<p>运行后的结果如下:</p>

<pre><code>  在jar包的同一目录下, 将会生成一个目录,一个jar,目录下有两个子目录,一个目录存放解压缩后的所有class,一个目录存放反编译后的java文件,jar包是用源码压缩生成的
</code></pre>

<p>几点说明:</p>

<pre><code>1. 工具中使用的WinRAR是自动识别安装路径的,请正确安装WinRAR
2. 工具使用的jad.exe,须与BAT放在同一目录,或者放在PATH可搜索到的位置
3.  jar包中非class文件,也会完整拷贝在源码目录下,方便生成源码工程
4. 生成的目录名与原 jar 包同名, 生成的源码 jar 包的文件名是在原名称中加入-src而生成, 如原 jar 包为 jdbc.jar, 则生成的目录名为 jdbc, 而生成的源码jar 包名则为 jdbc-src.jar
5. eclipse使用方法1, 将BAT生成的目录放在workspace中,然后创建同名工程
6. eclipse使用方法2,在 eclipse 中创建同名工程,使用src为源文件目录,bin为class文件目录,然后将BAT生成的目录拷贝在eclipse的workspace中 
</code></pre>

<p>该BAT为 blog.csdn.net/seavers 原创, BAT源码仅供个人学习,使用,研究,未经本人同意,不可用于商业用途</p>

<hr />

<p>我通常的使用方式是: 将 bat 与 jad.exe 解压在windows根目录, .jar右键用bat打开发后, 第二次及以后使用就方便多了</p>

<p>BAT更新了一下</p>

<p>BAT源码如下: (请直接拷贝在BAT文件中)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>::功能:     利用bat反编译jar包生成源码jar包
</span><span class='line'>::作者:     seavers
</span><span class='line'>::博客:     http://seavers.iteye.com/
</span><span class='line'>::版本:     1.7
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>::打开/关闭命令行显示
</span><span class='line'>REM @echo OFF
</span><span class='line'>
</span><span class='line'>::::::::::::::::::::::::::::解析并设置变量::::::::::::::::::
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>::查找jad文件的路径, 这里取的jad.exe, 表示从PATH中查找,如果想手工指定,需在这里修改
</span><span class='line'>set JAD_PATH=jad.exe
</span><span class='line'>
</span><span class='line'>::设置解压出的class文件存放的位置(相对路径)
</span><span class='line'>set CLASS_PATH=bin
</span><span class='line'>
</span><span class='line'>::设置反编译后的java文件存放的位置(相对路径)
</span><span class='line'>set JAVA_PATH=src
</span><span class='line'>
</span><span class='line'>::检查JAD文件是否存在bat所在目录下,
</span><span class='line'>if exist "%~dp0jad.exe" set JAD_PATH=%~dp0jad.exe
</span><span class='line'>
</span><span class='line'>::判断参数个数,如果没有文件参数,则报错,这里也可以使用%~f1,也可以用%1,没有关系,之后要去掉引号
</span><span class='line'>if ""%1""=="""" (set /P JAR_PATH=请输入要反编译的JAR包的路径...) else (set JAR_PATH=%~f1)
</span><span class='line'>if '%JAR_PATH:~0,1%%JAR_PATH:~0,1%'=='""' set JAR_PATH=%JAR_PATH:~1,-1%
</span><span class='line'>
</span><span class='line'>::获取源代码存放的路径,这里取JAR包所在路径,然后去掉".jar"作为文件夹路径, 这里的LOCATION不能带引号,因为下面还要追加字符)
</span><span class='line'>if ""%2""=="""" (set LOCATION=%JAR_PATH:~0,-4%) else (set LOCATION=%~f2)
</span><span class='line'>
</span><span class='line'>::::::::::::::::::::开始执行程序:::::::::::::::::::::::::::::::
</span><span class='line'>
</span><span class='line'>::获取WinRAR.exe的路径,设置在临时变量rarpath中
</span><span class='line'>for /f "usebackq delims=" %%i in (`ftype WinRAR`) do set RARPATH=%%i
</span><span class='line'>
</span><span class='line'>::对rarpath进行解析,去掉前面7个节符,去掉后面5个字符,得到WinRAR执行路径
</span><span class='line'>::路径大致是这样的形式  Winrar="C:\Program Files\WinRAR\WinRAR.exe" "%1"
</span><span class='line'>set RAREXE=%RARPATH:~7,-5%
</span><span class='line'>
</span><span class='line'>::调用WinRAR命令,解压文件到指定目录的bin目录下
</span><span class='line'>%RAREXE% x "%JAR_PATH%" "%LOCATION%\%CLASS_PATH%\"
</span><span class='line'>
</span><span class='line'>::遍历整个bin目录,取所有class文件,调用jad.exe反编译出源码,非class的拷贝到src目录下
</span><span class='line'>::打开变量延迟功能
</span><span class='line'>setlocal EnableDelayedExpansion
</span><span class='line'>for /r "%LOCATION%\bin" %%i in (*.*) do if '%%~xi'=='.class' ("%JAD_PATH%"  -o -r -sjava -ff -b -nonlb -space -t -8 -d"%LOCATION%\%JAVA_PATH%" "%%~si") else (set TEMP_PATH=%%i & echo f|xcopy "%%i" "!TEMP_PATH:%LOCATION%\bin=%LOCATION%\src!")
</span><span class='line'>endlocal EnableDelayedExpansion
</span><span class='line'>
</span><span class='line'>::将产生的java文件压缩成源码文件
</span><span class='line'>%RAREXE% a -ep1 -r "%LOCATION%-src.zip" "%LOCATION%\%JAVA_PATH%\*.*"
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>::::::::::::::::::程序结束, 显示运行结果::::::::::::::::::::::
</span><span class='line'>echo *********************************************
</span><span class='line'>echo 程序运行结束
</span><span class='line'>echo 解析的JAR包的路径为 %JAR_PATH%
</span><span class='line'>echo 解压缩工具WinRAR.exe的路径为 %RAREXE%
</span><span class='line'>echo 反编译工具JAD.exe的路径为 %JAD_PATH%
</span><span class='line'>echo 解析后的文件的根路径为 %LOCATION%
</span><span class='line'>echo 解析后的class文件存放在 %LOCATION%\%CLASS_PATH%
</span><span class='line'>echo 解析后的java文件存放在 %LOCATION%\%JAVA_PATH%
</span><span class='line'>echo 压缩后的java文件存放在 %LOCATION%-src.zip
</span><span class='line'>echo *********************************************
</span><span class='line'>pause
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012-01-12-1343766.html">sync.js</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-12T21:11:00+08:00" pubdate data-updated="true">Jan 12<span>th</span>, 2012</time>
      </p>
    
  </header>


  <div class="entry-content"><p>自己写了一个小工具, 做个备份</p>

<p>支持addTask任务, 每个任务将会同步执行</p>

<p>sync.js</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/*** 
</span><span class='line'> *   Sync 框架
</span><span class='line'> *
</span><span class='line'> *   支持 addTask,  addCirle,  addListener,  finish 等功能
</span><span class='line'> *
</span><span class='line'> */
</span><span class='line'>(function() {
</span><span class='line'>
</span><span class='line'>  var MAX_TOTAL = Math.pow(2, 31);
</span><span class='line'>
</span><span class='line'>  function Sync(delay) {
</span><span class='line'>      this.delay = delay;
</span><span class='line'>      this.queue = [];            //执行队列
</span><span class='line'>      this.listeners = [];            //listeners
</span><span class='line'>      this.timer = 0;
</span><span class='line'>      this.count = 0;             //总的计数
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype.setDelay = function(delay) {
</span><span class='line'>      this.delay = delay;
</span><span class='line'>      return this;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype.addListener = function(func) {
</span><span class='line'>      this.listeners.push(func);
</span><span class='line'>      return this;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype.removeListener = function(func) {
</span><span class='line'>      var pos = this.listeners.indexOf(func)
</span><span class='line'>      if (pos != -1) {
</span><span class='line'>          this.listeners.splice(pos);
</span><span class='line'>      }
</span><span class='line'>      return this;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype.addTask = function(func, callback) {
</span><span class='line'>      this.addCircle(1, func, callback);
</span><span class='line'>      return this;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype.addParallelTask = function(/** func1, func2, func3...  **/) {
</span><span class='line'>      this.addCircle(1, function(index) {
</span><span class='line'>          for(var i = 0; i &lt; arguments.length; i++) {
</span><span class='line'>              var func = arguments[i];
</span><span class='line'>              func(index);
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      return this;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype.addCircle = function(total, func, callback) {
</span><span class='line'>      if (typeof(total) == 'function') {
</span><span class='line'>          func = total;
</span><span class='line'>          total = MAX_TOTAL;
</span><span class='line'>      }
</span><span class='line'>      this.queue.push({
</span><span class='line'>          func : func, 
</span><span class='line'>          total : total,
</span><span class='line'>          index : 0,
</span><span class='line'>          callback : callback
</span><span class='line'>      });
</span><span class='line'>      this.checkStart();
</span><span class='line'>      return this;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype.checkStart = function(total, func) {
</span><span class='line'>      if (this.timer) {
</span><span class='line'>          return;
</span><span class='line'>      }
</span><span class='line'>      var that = this;
</span><span class='line'>      this.timer = setTimeout(function() {
</span><span class='line'>          var task = that.queue[0];
</span><span class='line'>          if (!task) {
</span><span class='line'>              that.timer = 0;
</span><span class='line'>              return ;
</span><span class='line'>          }
</span><span class='line'>          var ret = that._execute(task, task.index);
</span><span class='line'>          if (ret === true || ++task.index &gt;= task.total) {
</span><span class='line'>              that.queue.shift();
</span><span class='line'>              that._callback(task);
</span><span class='line'>          }
</span><span class='line'>          that.timer = setTimeout(arguments.callee, that.delay);          
</span><span class='line'>      }, this.delay);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype._execute = function(task, index) {
</span><span class='line'>      var ret = task.func(index);
</span><span class='line'>      for(var i = 0; i &lt; this.listeners.length; i++) {
</span><span class='line'>          this.listeners[i](this.count++);
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype._callback = function(task) {
</span><span class='line'>      task.callback && task.callback(index);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  Sync.prototype.finish = function(bool) {
</span><span class='line'>      if (this.timer) {
</span><span class='line'>          clearTimeout(this.timer);
</span><span class='line'>          this.timer = 0;
</span><span class='line'>      }
</span><span class='line'>      if (bool === undefined || bool === true) {
</span><span class='line'>          for(var i = 0; i &lt; this.queue.length; i++) {
</span><span class='line'>              var task = this.queue[i];
</span><span class='line'>              for(var j = task.index; j &lt; task.total; j++) {
</span><span class='line'>                  var ret = this._execute(task, j);
</span><span class='line'>                  if (ret === true) {
</span><span class='line'>                      break;
</span><span class='line'>                  }
</span><span class='line'>              }
</span><span class='line'>              
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      this.queue = [];
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  window.Sync = Sync;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>})();</span></code></pre></td></tr></table></div></figure>


<p>index.htm:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;script src="sync.js"&gt;&lt;/script&gt;
</span><span class='line'>&lt;script&gt;
</span><span class='line'>
</span><span class='line'>  var a = new Sync(1000);
</span><span class='line'>  a.addListener(function(n){console.log('notify .' + n)});
</span><span class='line'>  a.addCircle(2, function(n) {console.log('execute 2 -- ' + n)});
</span><span class='line'>  a.addCircle(4, function(n) {console.log('execute 4 -- ' + n)});
</span><span class='line'>  a.addCircle(8, function(n) {console.log('execute 8 -- ' + n)});
</span><span class='line'>  setTimeout(function() {
</span><span class='line'>      a.addCircle(function(n) {console.log('execute n -- ' + n)});
</span><span class='line'>      setTimeout(function() {
</span><span class='line'>          a.finish();
</span><span class='line'>      }, 3000);
</span><span class='line'>  }, 3000);
</span><span class='line'>
</span><span class='line'>&lt;/script&gt;
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011-10-01-1184400.html">with语句的本质</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-01T23:41:00+08:00" pubdate data-updated="true">Oct 1<span>st</span>, 2011</time>
      </p>
    
  </header>


  <div class="entry-content"><p>通过测试及debug后, 得出结论, 仅代表个人意见:</p>

<p>with的本质, 就是构造一个作用域, 将with的对象的所有key, 声明为局部变量</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>var inner = '123';
</span><span class='line'>var outer = {inner : 'hello world', another: 'hello with'};
</span><span class='line'>window.obj = {outer: outer};
</span><span class='line'>
</span><span class='line'>with(outer) {
</span><span class='line'>  alert(inner);
</span><span class='line'>  alert(another);
</span><span class='line'>  alert(outer.inner);
</span><span class='line'>  alert(window.obj.outer.inner);
</span><span class='line'>  show();
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>function show() {
</span><span class='line'>  alert(inner);
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>等同于以下代码</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>var inner = '123';
</span><span class='line'>var outer = {inner : 'hello world', another: 'hello with'};
</span><span class='line'>window.obj = {outer: outer};
</span><span class='line'>
</span><span class='line'>(function(inner, another) {
</span><span class='line'>  alert(inner);
</span><span class='line'>  alert(another);
</span><span class='line'>  alert(outer.inner);
</span><span class='line'>  alert(window.obj.outer.inner);
</span><span class='line'>  show();
</span><span class='line'>})(outer.inner, outer.another);
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>function show() {
</span><span class='line'>  alert(inner);
</span><span class='line'>
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>再看看下面这个常见的问题, 一目了然</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var root = { 
</span><span class='line'>    branch: { 
</span><span class='line'>        node: 1 
</span><span class='line'>    } 
</span><span class='line'>}; 
</span><span class='line'>
</span><span class='line'>with(root.branch) { 
</span><span class='line'>    root.branch = { 
</span><span class='line'>        node: 0 
</span><span class='line'>    }; 
</span><span class='line'>    // 显示 1, 错误! 
</span><span class='line'>    alert(node); 
</span><span class='line'>} 
</span><span class='line'>// 显示 0, 正确! 
</span><span class='line'>alert(root.branch.node); </span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011-09-17-1174269.html">display, position, float 之间的关系</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-17T22:52:00+08:00" pubdate data-updated="true">Sep 17<span>th</span>, 2011</time>
      </p>
    
  </header>


  <div class="entry-content"><p>从 css2.1 规范中翻译而来
出处见: <a href="http://www.w3.org/TR/CSS21/visuren.html#dis-pos-flo">http://www.w3.org/TR/CSS21/visuren.html#dis-pos-flo</a></p>

<p>Ps: 原文中的box未翻译, 可理解为盒模型, 或盒子</p>

<p>影响 产生box及布局的三个属性 &ndash; display, position, float 之间的关系如下:</p>

<ul>
<li>如果 display 的值为none, 则忽略position与float, 这种情况下, 元素不产生box</li>
<li>如果 position 的值为 absolute 或者 fixed, 则box绝对定位, float的值设定为 none , display 的值按照下面的表格来设定. box 的定位将决定于 top, right, bottom, left 属性及box的容器</li>
<li>如果 float 的值不是 none, 则 box 是浮动的且 display 按照下面的表格来设定</li>
<li>如果元素是根元素, display 按下面的表格来设定, 有一个例外: 当指定的值为list-item时,将变成计算后的 block 还是 list-item, 这点没有在CSS2.1中定义   (这句话不会翻译了)</li>
<li>剩余的 display 按照指定的方式来显示</li>
</ul>


<p>[table]
|specified value| computed value |
|inline-table   | table          |
|inline, table-row-group, table-column, table-column-group, table-header-group, table-footer-group, table-row, table-cell, table-caption, inline-block| block |
|others|same as specified |
[/table]</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011-06-23-1982081.html">手机游戏 cat physics 分数记录</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-06-23T19:48:00+08:00" pubdate data-updated="true">Jun 23<span>rd</span>, 2011</time>
      </p>
    
  </header>


  <div class="entry-content"><div class="iteye-blog-content-contain" style="font-size: 14px;">
<p> </p>
<p>记录一下分数</p>
<p> </p>
<p> </p>
<p> </p>
<table border="0"><tbody>
<tr>
<td>关数</td>
<td>我的分数</td>
<td>二星分数</td>
<td>三星分数</td>
<td>几星</td>
</tr>
<tr>
<td>1</td>
<td>752</td>
<td>750</td>
<td>750</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>690</td>
<td>600</td>
<td>690</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>496</td>
<td>490</td>
<td>500</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>508</td>
<td>500</td>
<td>520</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>604</td>
<td>590</td>
<td>600</td>
<td>3</td>
</tr>
<tr>
<td>6</td>
<td>581</td>
<td>550</td>
<td>570</td>
<td>3</td>
</tr>
<tr>
<td>7</td>
<td>614</td>
<td>450</td>
<td>570</td>
<td>3</td>
</tr>
<tr>
<td>8</td>
<td>671</td>
<td>660</td>
<td>670</td>
<td>3</td>
</tr>
<tr>
<td>9</td>
<td>574</td>
<td>540</td>
<td>570</td>
<td>3</td>
</tr>
<tr>
<td>10</td>
<td>801</td>
<td>750</td>
<td>800</td>
<td>3</td>
</tr>
<tr>
<td>11</td>
<td>573</td>
<td>560</td>
<td>600</td>
<td>2</td>
</tr>
<tr>
<td>12</td>
<td>458</td>
<td>440</td>
<td>500</td>
<td>2</td>
</tr>
<tr>
<td>13</td>
<td>464</td>
<td>500</td>
<td>515</td>
<td>1</td>
</tr>
<tr>
<td>14</td>
<td>511</td>
<td>530</td>
<td>610</td>
<td>1</td>
</tr>
<tr>
<td>15</td>
<td>673</td>
<td>650</td>
<td>690</td>
<td>2</td>
</tr>
<tr>
<td>16</td>
<td>738</td>
<td>700</td>
<td>730</td>
<td>3</td>
</tr>
<tr>
<td>17</td>
<td>542</td>
<td>500</td>
<td>560</td>
<td>2</td>
</tr>
<tr>
<td>18</td>
<td>611</td>
<td>550</td>
<td>630</td>
<td>2</td>
</tr>
<tr>
<td>19</td>
<td>734</td>
<td>690</td>
<td>730</td>
<td>3</td>
</tr>
<tr>
<td>20</td>
<td>711</td>
<td>650</td>
<td>710</td>
<td>3</td>
</tr>
<tr>
<td>21</td>
<td>483</td>
<td>320</td>
<td>500</td>
<td>2</td>
</tr>
<tr>
<td>22</td>
<td>372</td>
<td>310</td>
<td>350</td>
<td>3</td>
</tr>
<tr>
<td>23</td>
<td>464</td>
<td>450</td>
<td>540</td>
<td>2</td>
</tr>
<tr>
<td>24</td>
<td>621</td>
<td>450</td>
<td>610</td>
<td>3</td>
</tr>
<tr>
<td>25</td>
<td>603</td>
<td>570</td>
<td>600</td>
<td>3</td>
</tr>
<tr>
<td>26</td>
<td>659</td>
<td>600</td>
<td>640</td>
<td>3</td>
</tr>
<tr>
<td>28</td>
<td>417</td>
<td>335</td>
<td>450</td>
<td>2</td>
</tr>
<tr>
<td>29</td>
<td>507</td>
<td>450</td>
<td>520</td>
<td>2</td>
</tr>
<tr>
<td>30</td>
<td>491</td>
<td>460</td>
<td>470</td>
<td>3</td>
</tr>
<tr>
<td>31</td>
<td>473</td>
<td>420</td>
<td>470</td>
<td>3</td>
</tr>
<tr>
<td>32</td>
<td>539</td>
<td>510</td>
<td>540</td>
<td>2</td>
</tr>
<tr>
<td>33</td>
<td>601</td>
<td>590</td>
<td>600</td>
<td>3</td>
</tr>
<tr>
<td>34</td>
<td>355</td>
<td>320</td>
<td>340</td>
<td>3</td>
</tr>
<tr>
<td>35</td>
<td>484</td>
<td>450</td>
<td>465</td>
<td>3</td>
</tr>
<tr>
<td>36</td>
<td>488</td>
<td>350</td>
<td>450</td>
<td>3</td>
</tr>
<tr>
<td>37</td>
<td>589</td>
<td>500</td>
<td>580</td>
<td>3</td>
</tr>
<tr>
<td>38</td>
<td>700</td>
<td>450</td>
<td>700</td>
<td>3</td>
</tr>
<tr>
<td>39</td>
<td>424</td>
<td>150</td>
<td>250</td>
<td>3</td>
</tr>
<tr>
<td>40</td>
<td>698</td>
<td>670</td>
<td>680</td>
<td>3</td>
</tr>
<tr>
<td>41</td>
<td>421</td>
<td>350</td>
<td>420</td>
<td>3</td>
</tr>
<tr>
<td>42</td>
<td>546</td>
<td>450</td>
<td>540</td>
<td>3</td>
</tr>
<tr>
<td>43</td>
<td>525</td>
<td>500</td>
<td>520</td>
<td>3</td>
</tr>
<tr>
<td>44</td>
<td>496</td>
<td>350</td>
<td>450</td>
<td>3</td>
</tr>
<tr>
<td>45</td>
<td>559</td>
<td>550</td>
<td>600</td>
<td>2</td>
</tr>
<tr>
<td>46</td>
<td>512</td>
<td>500</td>
<td>675</td>
<td>2</td>
</tr>
<tr>
<td>47</td>
<td>566</td>
<td>550</td>
<td>600</td>
<td>2</td>
</tr>
<tr>
<td>48</td>
<td>505</td>
<td>500</td>
<td>505</td>
<td>3</td>
</tr>
<tr>
<td>49</td>
<td>452</td>
<td>450</td>
<td>490</td>
<td>2</td>
</tr>
<tr>
<td>50</td>
<td>498</td>
<td>400</td>
<td>460</td>
<td>3</td>
</tr>
<tr>
<td>51</td>
<td>472</td>
<td>520</td>
<td>465</td>
<td>1</td>
</tr>
<tr>
<td>52</td>
<td>610</td>
<td>630</td>
<td>642</td>
<td>1</td>
</tr>
<tr>
<td>53</td>
<td>745</td>
<td>650</td>
<td>745</td>
<td>3</td>
</tr>
<tr>
<td>54</td>
<td>608</td>
<td>580</td>
<td>610</td>
<td>2</td>
</tr>
<tr>
<td>55</td>
<td>410</td>
<td>360</td>
<td>400</td>
<td>3</td>
</tr>
<tr>
<td>56</td>
<td>744</td>
<td>680</td>
<td>750</td>
<td>2</td>
</tr>
<tr>
<td>57</td>
<td>564</td>
<td>400</td>
<td>500</td>
<td>3</td>
</tr>
<tr>
<td>58</td>
<td>562</td>
<td>50</td>
<td>555</td>
<td>3</td>
</tr>
<tr>
<td>59</td>
<td>306</td>
<td>320</td>
<td>330</td>
<td>1</td>
</tr>
<tr>
<td>60</td>
<td>648</td>
<td>570</td>
<td>660</td>
<td>2</td>
</tr>
<tr>
<td>61</td>
<td>473</td>
<td>400</td>
<td>520</td>
<td>2</td>
</tr>
<tr>
<td>62</td>
<td>681</td>
<td>640</td>
<td>680</td>
<td>3</td>
</tr>
<tr>
<td>63</td>
<td>647</td>
<td>580</td>
<td>640</td>
<td>3</td>
</tr>
<tr>
<td>64</td>
<td>647</td>
<td>600</td>
<td>645</td>
<td>3</td>
</tr>
<tr>
<td>65</td>
<td>763</td>
<td>590</td>
<td>780</td>
<td>2</td>
</tr>
<tr>
<td>66</td>
<td>410</td>
<td>540</td>
<td>545</td>
<td>1</td>
</tr>
<tr>
<td>67</td>
<td>581</td>
<td>530</td>
<td>575</td>
<td>3</td>
</tr>
<tr>
<td>68</td>
<td>702</td>
<td>700</td>
<td>780</td>
<td>2</td>
</tr>
<tr>
<td>69</td>
<td>577</td>
<td>390</td>
<td>425</td>
<td>3</td>
</tr>
<tr>
<td>70</td>
<td>722</td>
<td>650</td>
<td>730</td>
<td>2</td>
</tr>
<tr>
<td>71</td>
<td>526</td>
<td>481</td>
<td>513</td>
<td>3</td>
</tr>
<tr>
<td>72</td>
<td>602</td>
<td>580</td>
<td>604</td>
<td>2</td>
</tr>
<tr>
<td>73</td>
<td>681</td>
<td>585</td>
<td>619</td>
<td>3</td>
</tr>
<tr>
<td>74</td>
<td>571</td>
<td>520</td>
<td>561</td>
<td>3</td>
</tr>
<tr>
<td>75</td>
<td>749</td>
<td>690</td>
<td>730</td>
<td>3</td>
</tr>
<tr>
<td>76</td>
<td>732</td>
<td>627</td>
<td>690</td>
<td>3</td>
</tr>
<tr>
<td>77</td>
<td>638</td>
<td>540</td>
<td>600</td>
<td>3</td>
</tr>
<tr>
<td>78</td>
<td>591</td>
<td>540</td>
<td>580</td>
<td>3</td>
</tr>
<tr>
<td>79</td>
<td>566</td>
<td>520</td>
<td>565</td>
<td>3</td>
</tr>
<tr>
<td>80</td>
<td>610</td>
<td>500</td>
<td>595</td>
<td>3</td>
</tr>
<tr>
<td>81</td>
<td>596</td>
<td>550</td>
<td>580</td>
<td>3</td>
</tr>
<tr>
<td>82</td>
<td>407</td>
<td>400</td>
<td>470</td>
<td>2</td>
</tr>
<tr>
<td>83</td>
<td>538</td>
<td>525</td>
<td>550</td>
<td>2</td>
</tr>
<tr>
<td>84</td>
<td>600</td>
<td>530</td>
<td>565</td>
<td>3</td>
</tr>
<tr>
<td>85</td>
<td>534</td>
<td>600</td>
<td>630</td>
<td>1</td>
</tr>
<tr>
<td>86</td>
<td>379</td>
<td>300</td>
<td>320</td>
<td>3</td>
</tr>
<tr>
<td>87</td>
<td>530</td>
<td>500</td>
<td>530</td>
<td>3</td>
</tr>
<tr>
<td>88</td>
<td>652</td>
<td>600</td>
<td>650</td>
<td>3</td>
</tr>
<tr>
<td>89</td>
<td>607</td>
<td>595</td>
<td>605</td>
<td>3</td>
</tr>
<tr>
<td>90</td>
<td>632</td>
<td>610</td>
<td>630</td>
<td>3</td>
</tr>
</tbody></table>
<p> </p>
<p> </p>
<p> </p>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011-06-12-1078292.html">javascript模拟html5新增特性 - placeholder属性</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-06-12T00:11:00+08:00" pubdate data-updated="true">Jun 12<span>th</span>, 2011</time>
      </p>
    
  </header>


  <div class="entry-content"><p>placeholder属性是html5的新增属性,当输入框为空时, 可以提示一些信息, 非常不错的功能</p>

<ol>
<li><p>placeholder支持情况:
  a) 已经支持: ie 9+  firefox 4.0+  chrome等
  b) 需要模拟 :  ie6 ie7 ie8 firefox3.6</p></li>
<li><p>placeholder
  a) 内容为空时, 内容显示为placeholder内容, 样式为color:#999 , 且垂直居中显示
  b) 内容不为空, 无特殊变化, 原有placeholder样式, 需清除</p></li>
<li><p>模拟placeholder, 要求满足( 只考虑 input)
  a) 当页面显示后, 如果数据为空, 则显示为placeholder状态
  b) 当点击input后, 清除placeholder,样式恢复文本样式
  c) 当input离开焦点后, 根据内容来显示placeholder状态
  d) 当placeholder状态时,刷新页面后, 也应该是placeholder状态
  e) 当有js执行脚本后, 且变更input值后, 重置placeholder状态
  f) 当表单reset后, 也需要重置placeholder状态
  g) 当表单提交后, 当为placeholder状态时,提交的参数应该为空</p></li>
<li><p>注意点
  a) firefox 3.6 ,需考虑 3.d)点, 需监停 window.onunload
  b) ie下, 第3.e)点,需监控 onpropertychange事件,比较复杂
  c) firefox , 需监控 oninput 事件, 也比较复杂
  d) form.reset事件, onreset是在修改input值前调用的, 也比较难重置状态</p></li>
<li><p>判断浏览器是否原生支持placeholder :  &ldquo;placeholder&rdquo; in document.createElement(&ldquo;input&rdquo;)</p></li>
<li>简单实现, 可以监停focus/blur(focusin/focusout), submit/unload事件</li>
<li>本文发表在<a href="http://seavers.iteye.com/">http://seavers.iteye.com/</a> 本文未经同意,谢绝转载</li>
</ol>


<p>例:</p>

<p>KISSY 实现:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>input.placeholder {color:#999}</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;script src="http://a.tbcdn.cn/s/kissy/1.1.6/kissy-min.js"&gt;&lt;/script&gt;
</span><span class='line'>&lt;script&gt;
</span><span class='line'>//本代码发布在 http://seavers.iteye.com/ , 未经同意,谢绝转载
</span><span class='line'>//模拟了placeholder 80%的功能
</span><span class='line'>(function() {
</span><span class='line'>  var S=KISSY, Dom = S.DOM, Event = S.Event;
</span><span class='line'>
</span><span class='line'>  S.namespace("HTML5");
</span><span class='line'>  S.HTML5.placeholder = {
</span><span class='line'>      support  : "placeholder" in document.createElement("input"), 
</span><span class='line'>      activate : (function() {
</span><span class='line'>          function _showPlaceholder(el, className, value) {
</span><span class='line'>              if (!Dom.hasClass(el, className) && !el.value) {
</span><span class='line'>                  el.value = value;
</span><span class='line'>                  Dom.addClass(el, className);
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>          
</span><span class='line'>          function _hidePlaceholder(el, className, value) {
</span><span class='line'>              if (Dom.hasClass(el, className)) {
</span><span class='line'>                  el.value = value;
</span><span class='line'>                  Dom.removeClass(el, className);
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>          
</span><span class='line'>          function _activatePlaceholder(selector) {
</span><span class='line'>              var ATTR = "placeholder", CLASS = "placeholder";
</span><span class='line'>              
</span><span class='line'>              S.each(S.query(selector), function(el){
</span><span class='line'>                  var TIP = el.getAttribute(ATTR);
</span><span class='line'>                  if (!TIP) return ;
</span><span class='line'>                  
</span><span class='line'>                  Event.on(el.form, 'submit', function(ev) {
</span><span class='line'>                      _hidePlaceholder(el, CLASS, "");
</span><span class='line'>                  });
</span><span class='line'>                  Event.on(window, 'unload', function(ev) {   //解决firefox3.6刷新问题
</span><span class='line'>                      _hidePlaceholder(el, CLASS, "");
</span><span class='line'>                  });
</span><span class='line'>                  Event.on(el, 'focusin', function(ev){
</span><span class='line'>                      _hidePlaceholder(el, CLASS, "");
</span><span class='line'>                  });
</span><span class='line'>                  Event.on(el, 'focusout', function(ev){
</span><span class='line'>                      _showPlaceholder(el, CLASS, TIP);
</span><span class='line'>                  });
</span><span class='line'>                  _showPlaceholder(el, CLASS, TIP);
</span><span class='line'>              });
</span><span class='line'>          }
</span><span class='line'>          
</span><span class='line'>          return _activatePlaceholder;
</span><span class='line'>      })()
</span><span class='line'>  };
</span><span class='line'>  
</span><span class='line'>  //如果有原生的placeholder，使用原生，否则使用模拟的
</span><span class='line'>  if (!S.HTML5.placeholder.support) {
</span><span class='line'>      S.HTML5.placeholder.activate('INPUT');
</span><span class='line'>  }
</span><span class='line'>})();
</span><span class='line'>
</span><span class='line'>&lt;/script&gt;</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011-02-11-904122.html">version compare</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-11T21:34:00+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2011</time>
      </p>
    
  </header>


  <div class="entry-content"><p>[img]<a href="http://dl.iteye.com/upload/attachment/412672/dda5fd96-afce-3f8c-bdf3-bf20b8228fe7.jpg">http://dl.iteye.com/upload/attachment/412672/dda5fd96-afce-3f8c-bdf3-bf20b8228fe7.jpg</a>[/img]</p>

<p>Apache log4j™ 1.3 development has been abandoned and no future releases or development is anticipated. Users of Apache log4j 1.3 are encouraged to migrate to Apache log4j 1.2 or to monitor and contribute to the Apache log4j 2.0 development effort. The companions for Apache log4j 1.2 provide many of the features that were developed during the Apache log4j 1.3 development effort.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/8/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/6/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/android/'>android (2)</a></li>
<li class='category'><a href='/blog/categories/chrome/'>chrome (1)</a></li>
<li class='category'><a href='/blog/categories/css/'>css (3)</a></li>
<li class='category'><a href='/blog/categories/cubieboard/'>cubieboard (3)</a></li>
<li class='category'><a href='/blog/categories/git/'>git (2)</a></li>
<li class='category'><a href='/blog/categories/hive/'>hive (1)</a></li>
<li class='category'><a href='/blog/categories/html5/'>html5 (1)</a></li>
<li class='category'><a href='/blog/categories/java/'>java (8)</a></li>
<li class='category'><a href='/blog/categories/javascript/'>javascript (10)</a></li>
<li class='category'><a href='/blog/categories/maven/'>maven (5)</a></li>
<li class='category'><a href='/blog/categories/nginx/'>nginx (1)</a></li>
<li class='category'><a href='/blog/categories/octopress/'>octopress (3)</a></li>
<li class='category'><a href='/blog/categories/php/'>php (1)</a></li>
<li class='category'><a href='/blog/categories/ruby/'>ruby (5)</a></li>
<li class='category'><a href='/blog/categories/ubuntu/'>ubuntu (20)</a></li>
<li class='category'><a href='/blog/categories/思考/'>思考 (9)</a></li>

  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014-01-19-ruby-multiple-return.html">ruby语法糖 - 多返回值</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-01-12-ruby-enumerable.html">ruby Enumerator</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-01-05-ruby-string-array.html">ruby 字符串与数组</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-01-04-ruby-study-notes.html">ruby 学习笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013-12-31-iteye-blog-migration.html">iteye 博客迁移</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>大牛博客</h1>
  <ul>
    <li>
      <a href="http://ithans.com/">ithans</a>
    </li>
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - seavers -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>
</footer>
  <script src="/javascripts/libs/jquery.min.js"></script>
<script src="/javascripts/octopress.js"></script>

<script src=" http://tjs.sjs.sinajs.cn/open/api/js/wb.js?appkey=3919158905" charset="utf-8"></script>
<script src="/javascripts/blog.js"></script>
<script src='http://hm.baidu.com/h.js?f1e7ae48ee023d8ed983af30c485b5ce'></script>


</body>
</html>
